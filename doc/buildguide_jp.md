# Build Guide
こちらはHalfcliffのビルドガイドです。
基本セット(左右ProMicro基板＋左右キースイッチ基板＋左右JIS拡張基板）の組み立て方法が記載されています。
(まだ作成中につき注意)

大まかな流れは以下の通りです。
*   同梱品の確認
*   別途必要な部品の準備、確認
*   左右ProMicro基板の組み立て
*   左右キースイッチ基板の組み立て
*   左右拡張基板(JIS)の組み立て
*   各基板の接続、ボトムプレートの取り付け
*   動作確認


# 同梱品の確認
各基板用の部品が揃っていることを確認します。
ねじ、スペーサー等は左右での合計数を記載しています。
(文字だけでは分かりにくい部品は、組み立ての各手順にある写真も見てみてくださいね。)
M2x2mm中空スペーサー等、予備の部品が付属しているものもあります。

*   左右ProMicro基板用

|名前|合計数|備考|
|:-|:-|:-|
ProMicro基板|	2	|	表にControl Boardと書いてある基板です。左JIS拡張基板と繋がっていることもあります。|
1x9L字ピンソケット	|	4	|	9ピンのL字型のピンソケットです。樹脂部分の長さは8.5㎜です。	|
1x12ピンソケット	|	4	|	黒色の12ピンのピンソケットです。樹脂部分の長さは5.7㎜です。	|
リセットスイッチ	|	2	|	ボタンがある四角い部品です。	|
2x4細ピンヘッダ(2mmピッチ)	|	2	|	2x4ピンのピンソケットです。	|
ジャンパピン(2mmピッチ）	|	4	|	内部に金属端子がある、黒色の四角い樹脂製の部品です。	|
TRRSジャック	|	2	|	TRRSケーブルを接続する穴がある四角い部品です。	|
1x4ピンソケット(ロープロファイル)	|	2	|	4ピンの背が低いピンソケットです。	|
M2x2mm中空スペーサー	|	8(4つは予備)	|	長さ2mm円柱の形をした部品です。(厚めのワッシャのような部品です。)	|
M2x8mmなべ小ねじ	|	4	|	銀色の長さ8㎜のねじです。	|
M2ナット	|	4	|	銀色の六角形の部品です。	|

*   左右キースイッチ基板用

|名前|合計数|備考|
|:-|:-|:-|
左キースイッチ基板	|	1	|	表にLeft Switch Boardと書いてある基板です。
右キースイッチ基板	|	1	|	表にRight Switch Boardと書いてある基板です。
トッププレート	|	2	|	四角い穴の開いた白色のうち、一番大きいものです。
左ボトムプレート|	1	|	アクリル製の透明な板のうち、二番目に大きいものです。
右ボトムプレート|	1	|	アクリル製の透明な板のうち、一番大きいものです。
1x9L字ピンヘッダ	|	4	|	9ピンのL字型のピンヘッダです。
ダイオード	|	50	|	リードタイプのダイオードです。
1x9ロープロファイルピンヘッダ	|	1	|	9ピンの背が低いピンヘッダです。拡張基板未使用時は余ります。
1x8ロープロファイルピンヘッダ	|	1	|	8ピンの背が低いピンヘッダです。拡張基板未使用時は余ります。
1x4ロープロファイルピンソケット|	2	|	4ピンの背が低いピンソケットです。
M2x7mmスペーサー	|	12	|	銀色の円柱の形をした部品です。
M2x4mmねじ	|	20	|	銀色の長さ4㎜のねじです。
M2x8mmなべ小ねじ	|	4	|	銀色の長さ6㎜のねじです。	|
ProMicroカバー	|	2	|	アクリル製の透明な板のうち、一番小さいものです。|
ゴム足	|	8	|	透明なゴム足です。シートに貼り付けてあります。
LEDテープ	|	2	|	1枚当たり5つのLEDが付いたテープ状の部品です。


*   拡張基板(JIS)

|名前|合計数|備考|
|:-|:-|:-|
左JIS拡張基板	|	1	|	表にLeft Extension Boardと書いてある基板です。ProMicro基板と繋がっています。
右JIS拡張基板	|	1	|	表にRight Extension Boardと書いてある基板です。
左JIS拡張基板用トッププレート	|	1	|	四角形の穴が開いた白色の基板のうち、一番小さいものです。
右JIS拡張基板用トッププレート	|	1	|	四角形の穴が開いた白色の基板のうち、二番目に大きいものです。
ダイオード	|	25	|	リードタイプのダイオードです。
1x8ロープロファイルピンヘッダ	|	1	|	8ピンの背が低いピンヘッダです。
1x9ロープロファイルピンヘッダ	|	1	|	9ピンの背が低いピンヘッダです。
ジャンパピン	|	17	|	内部に金属端子がある、四角い樹脂製の部品です。
M2x7mmスペーサー	|	8	|	銀色の円柱の形をした部品です。
M2x4mmなべ小ねじ	| 16	|	銀色の長さ4㎜のねじです。


# 別途必要な部品の準備、確認
以下の部品を用意します。

|名前|合計数|備考|
|:-|:-|:-|
pro micro	|	2	|	ProMicro、または互換品です。
ピンヘッダ1x12	|	4	|	12ピンのピンヘッダです。ProMicroの袋に同梱されているものを使います。
スタビライザー	|	2	|	キースイッチのような部品2つが金属製のシャフトでつながった部品です。
キーキャップ	|	75	|	CherryMX互換品のキーキャップが必要です。例えば[これ](https://www.diatec.co.jp/shop/det.php?prod_c=4130)
キースイッチ	|	75	|	Cherry MX互換品が必要です。
TRRSケーブル	|	1	|	TRRSジャックに接続するケーブルです。


# 組立に必要な工具の用意
Halfcliff組立て時に自分が使用したものを以下に記載します。
* はんだごて
* はんだこて台
* はんだ
* 簡易はんだ吸い取り機(ハッコースッポン 20Gを使用しました。)
* フラックス
* ピンセット
* マスキングテープ
* 精密ドライバー
* 大き目のクリップ(キースイッチのはんだ付け時に、キースイッチを基板に固定するために使用しました。)
* ニッパー
* 鉄やすり
* 瞬間接着剤(主にピンソケットの取付け時に使用します。使う場合は部品の樹脂部分に少量だけ塗布(金属部分にはつかないように注意です！！)し、基板に接着します。)
* ハックルー(ProMicroのモゲ対策として、エポキシ接着剤の代わりに使いました。)

他にも、こちらのサリチル酸様のWebページも非常に参考になるかと思います。(この場を借りて感謝申し上げます。)
[自作キーボードを作るために必要なもの - 自作キーボード温泉街の歩き方](https://salicylic-acid3.hatenablog.com/entry/tool-lubrication)


# 組立時の主な注意点
* ProMicro基板の組み立て時、1x9L字ピンソケットの向きに注意してください。(後の手順で詳細を記載しています。)
* ダイオードをはんだ付けする際の向きに注意してください。
* はんだ付け時にキースイッチやピンソケット、ピンヘッダ等の部品が基板から浮かないように注意してください。
* ジャンパピンの取り付け位置に注意してください。
* LEDテープ等、はんだが乗りにくい箇所のはんだ付けする箇所にフラックスを薄く塗布してからはんだ付けしてください。(特にLEDテープのはんだ付け)
* はんだ付けした部品のはんだを吸い取って取り外す場合、吸い取りが不十分な状態で無理に取り外すと、基板の銅箔がはがれる可能性があるので注意してください。

# 左右ProMicro基板の組み立て
左右ProMicro基板を組み立てます。(つまり、各作業を2回行うことになります。)

おおまかな流れは以下の通りです。
* (左JIS拡張基板とProMicro基板が繋がっている場合)コントロール基板の切り離し
* 1x9L字ピンソケット2つのはんだ付け
* 1x4ロープロファイルピンソケットのはんだ付け
* 1x12ピンソケット2つのはんだ付け
* リセットスイッチのはんだ付け
* 2x4ピンヘッダのはんだ付け
* 2x4ピンヘッダへのジャンパピンの取り付け
* TRRSジャックのはんだ付け
* ProMicroへの1x12ピンヘッダ2つのはんだ付け
* 1x12ピンソケットへのProMicroの取付け

画像は主に右ProMicro基板のものですが、左の組み立て方法も殆ど同じです。

左右で方法が大きく異なるものには、左用の画像も用意しています。


# コントロール基板の切り離し
(左JIS拡張基板とProMicro基板が繋がっている場合)ProMicro基板と左拡張基板(JIS)をニッパー等で切り離します。

(切り離し前の画像)
(切り離し後の画像)

あとで触ってケガしないよう、鋭い部分が残らないよう切り離してください。

切り残しが基板の凹みより内側にあれば、組立て時に干渉することはありません。


# 切り離したPromicro基板の整形
気になる場合は、ProMicro基板の切り離した部分を、鉄ヤスリ等で削ります。

(削った後の画像)



# 1x9L字ピンソケット2つのはんだ付け
基板に1x9L字ピンソケット2つを取り付け、はんだ付けします。

左右の基板ではんだ付けの向きが異なるので注意してください。

(左基板へ1x9L字ピンソケットをはんだ付けした後の写真)

(右基板へ1x9L字ピンソケットをはんだ付けした後の写真)

まずはピンソケットの端子1つをはんだ付けし、ピンソケットが基板から浮いていないことを確認します。

(ピンソケットの1つの端子のみはんだ付けした状態の画像)

浮いている場合は、はんだを溶かしながら位置を調整するとよいです。

問題が無ければ残りの端子をはんだ付けします。

(はんだ付け後の画像)

# 1x4ロープロファイルピンソケットのはんだ付け
基板に1x4ロープロファイルピンソケットを取り付け、はんだ付けします。

L字ピンソケット同様、端子1つをはんだ付けした時点で、ピンソケットが基板から浮いていないことを確認するとよいです。

(はんだ付け後の画像)


# 2x4細ピンヘッダ(2mmピッチ)のはんだ付け
2x4細ピンヘッダ(2mmピッチ)を取り付け、はんだ付けします。

1x12ピンソケットの後にはんだ付けするのは少し大変なので、その前のはんだ付けをお勧めします。

ピン同士がはんだでくっつかないよう注意してください。

(画像では1x12ピンソケットを先にはんだ付けしてしまっていますが、ピンソケットの後のはんだ付けはとてもやりにくいので、ここでのはんだ付けをおすすめします。)

(はんだ付け後の画像)


#  1x12ピンソケット2つのはんだ付け
基板へ1x12ピンソケット2つを取り付け、はんだ付けします。

(はんだ付け後の画像)


# リセットスイッチのはんだ付け
基板へリセットスイッチを取り付け、はんだ付けします。リセットスイッチに向きはありません。

必要なはんだの量はピンソケットより多めです。

(はんだ付け後の画像)


# ジャンパピンの取り付け
はんだ付けしたピンヘッダへジャンパピンを取り付けます。

画像の位置に取り付けてください。

(取り付け後の画像)

※(おまけ)ピンの位置を変更することで、左右のキーボード間の通信をI2Cで行うこともできます。

その場合、以下の画像を参考にジャンパピンの取り付けを行ってください。

ただし、通信をI2Cで行う場合、ファームウェアの変更が必要となります。方法を知っている方向けです。


(I2C通信時のジャンパピンの取り付け位置１)

(I2C通信時のジャンパピンの取り付け位置２)

# TRRSジャックのはんだ付け
基板へTRRSジャックを取り付け、はんだ付けします。

左右の基板で取付場所が異なるので注意してください。

(左のはんだ付け後の画像４)

(右のはんだ付け後の画像)

…といっても、順番通りに組み立てれば、使用しない取り付け場所は1x9L字ピンヘッダで塞がれるので問題無いはずです。

# ProMicroへの1x12ピンヘッダ2つのはんだ付け
ProMicroへ1x12ピンヘッダ2つを画像のようにはんだ付けします。
 
ピンヘッダの長い方がProMicro側ですので注意してください。

(はんだ付け後の画像)
 
また、できればここでProMicroのUSB端子のモゲ対策をしておくとよいです。

はんだ付け後、余分なピンをニッパー等で切り落とします。(切り落とさないと、ProMicroカバーと干渉してしまいます。)

(ピンを切り落とした後の画像)
 
# 1x12ピンソケットへのProMicroの取付け
　ProMicroをピンソケットへ取り付けます。
 
 (取り付け後、つまり組み立て完了後の画像)

以上でProMicro基板の組み立ては完了です。


# 左右キースイッチ基板の組み立て
左右のキースイッチ基板を組み立てます。(つまり、各作業を2回(ry)

おおまかな流れは以下の通りです。
* ダイオードのはんだ付け
* 1x9L字ピンヘッダ2つのはんだ付け
* 1x4ロープロファイルピンソケットのはんだ付け
* 1x8(右は1x9)ロープロファイルピンヘッダのはんだ付け
* ProMicro基板とキースイッチ基板の接続
* 左右キースイッチの入力動作テスト
* トッププレートへのキースイッチ(四隅）の取り付け、はんだ付け
* 残りのキースイッチの取り付け、はんだ付け
* M2x7mmスペーサー4つの取り付け
* スペーサーのトッププレートへのねじ止め

# ダイオードのはんだ付け
リードタイプのダイオードを左右のキースイッチ基板に取り付け、はんだ付けします。

ダイオードは左右で各25個、合計50個使用します。

まずは50個のダイオードのリードを曲げます。

ダイオードの根本付近で曲げれば、基板へ取り付け可能な状態になります。

(ダイオードを曲げた状態の画像)

リードを曲げたらダイオードを、画像のように基板のシルクとの向きを合わせて取り付けます。

(ダイオードの向きがわかる画像)

取り付け(とはんだ付け)は5個ずつくらいで行うとよいです。 

右手用のダイオード2つのみ、ほかのダイオードと異なる場所にあるので注意してください。

(右手側のダイオード2つの位置がわかる画像)


取り付けが完了したらはんだ付けをします。


はんだ付け後、不要なリードをニッパーなどで切り落とします。

(ダイオードのリードを切り落とした後の画像)

この作業を50個のダイオードに対して行います。

# 1x9L字ピンヘッダ2つのはんだ付け
基板に1x9L字ピンヘッダ2つを取り付け、はんだ付けします。

L字ピンヘッダの取り付け方法に注意してください。

（L字ピンヘッダの取り付け向きがわかる画像)
 
# 1x4ロープロファイルピンソケットのはんだ付け
1x4ロープロファイルピンソケットを取り付け、はんだ付けします。


(はんだ付け後の画像表)
(はんだ付け後の画像裏)

# 1x8(右は1x9)ロープロファイルピンヘッダのはんだ付け
左キースイッチ基板に1x8ロープロファイルピンヘッダ、

右キースイッチ基板に1x9ロープロファイルピンヘッダを取り付け、はんだ付けします。

ピンヘッダの短い方が基板側になるように取り付けてください。

(ピンヘッダの取り付け向きがわかる画像)

# ProMicro基板とキースイッチ基板の接続
動作テストのために、画像のように左右のProMicro基板とキースイッチ基板を接続します。

(画像)

# 左右キースイッチ基板の動作テスト
左右キースイッチ基板の動作テストはここで行うのがおすすめです。

動作テストの手順は以下のリンクに記載しています。(作成中)
[入力動作テスト]()

# ProMicro基板とキースイッチ基板の分離
動作確認完了後、組立進行のためにProMicro基板とキースイッチ基板を分離します。

# トッププレートへのM2x7mmスペーサー取り付け

画像のように、左右のトッププレートへM2x7mmスペーサーを、M2x6mmねじで取り付けます。

左右のトッププレートで取り付け向きが異なるので注意して下さい。

(スペーサー取り付け後の左右のトッププレートの画像)


# トッププレートへのキースイッチ(四隅）の取り付け、はんだ付け
まずはトッププレートの四隅へキースイッチを取り付けます。

その後、トッププレートを取り付けたキースイッチを、キースイッチ基板に取り付けます。

取り付け時に、キースイッチのピンが基板の穴に正しく入っていることを確認してください。

入っていない場合は、ピン曲がっている等の異常がないかを確認します。

正しく取り付けたら、四隅のいずれかのキースイッチの2つのピンのうち1つを、

キースイッチ基板から浮かないようにはんだ付けします。

マスキングテープで基板にキースイッチを固定したり、大き目のクリップで基板とキースイッチを挟む等の方法がおすすめです。

端子とパッド間は十分な量のはんだではんだ付けしてください。(画像程度のはんだの量なら大丈夫です。)

(はんだの量を示す画像)

はんだ付け後、キースイッチが浮いていないことを確認します。浮いている場合は修正します。

確認後、残りのピンをはんだ付けします。

同様の作業を、残り3つのキースイッチに対しても行います。

# 残りのキースイッチの取り付け、はんだ付け
残りのキースイッチを取り付け、はんだ付けを行います。

一部のスイッチについては、トッププレートの形状の関係上、他と比べて基板から浮きやすいので、

特に注意してはんだ付けします。

(浮きやすいキースイッチ基板の位置を示す画像)

# LEDテープのはんだ付け
LEDテープ裏面のシールをはがします。

その後、画像を参考にしてLEDテープの向きを合わせます。

(LEDテープの向きがわかる画像)

その後、左右キースイッチ基板へLEDテープを貼り付けます。

貼り付け後、LEDテープの端子にフラックスを塗布し、はんだ付けします。

(はんだ付け後の画像)

# M2x7mmスペーサー4つの取り付け
キースイッチ基板へM2x7㎜スペーサー4つを取り付けます。

(画像いらない)

# スペーサーのトッププレートへのねじ止め
M2x7mmスペーサーをトッププレートにM2x4mmねじでねじ止めします。

(ねじ止め後の画像)

以上でキースイッチ基板の組み立ては完了です。

(組み立て後の画像)

次は左右の拡張基板の組み立てを行います。

# 左右の拡張基板(JIS)の組み立て

左右の拡張基板(JIS)を組み立てます。(つまり、各(ry)

おおまかな流れは以下の通りです。
* (左のみ）ProMicro基板と繋がっていた部分の整形、やすりがけ
* ダイオードのはんだ付け
* 1x8(右は1x9)ロープロファイルピンヘッダのはんだ付け
* (右のみ)スタビライザーの取り付け
* トッププレートへのキースイッチ(四隅）の取り付け、はんだ付け
* 残りのキースイッチの取り付け、はんだ付け
* 拡張基板へのM2x7mmスペーサー4つの取り付け
* スペーサーのトッププレートへのねじ止め
* ボトムプレートへのゴム足の取り付け
* キーキャップの取り付け
* 組み立て後の動作確認


# (左のみ）ProMicro基板と繋がっていた部分の整形、やすりがけ
左基板のProMicro基板と繋がっていた部分を、鋭い部分が残らないように切り離します。

(削った後の画像)

# ダイオードのはんだ付け
リードタイプのダイオードをキースイッチ基板に取り付け、はんだ付けします。

ダイオードは左基板10個、右基板15個、合計25個使用します。

手順はキースイッチ基板の時と同様ですが、向きがキースイッチ基板とは逆なので注意してください。

(シルクとダイオードの向きを揃えればOK) 

# 1x8(右は1x9)ロープロファイルピンヘッダのはんだ付け
左基板に1x8ロープロファイルピンヘッダ、

右基板に1x9ロープロファイルピンヘッダを取り付け、はんだ付けします。

ピンヘッダの短い方が基板側になるように取り付けてください。

(ピンヘッダの取り付け向きがわかる画像)

#  (右のみ)スタビライザーの取り付け
右拡張基板にスタビライザー2つを取り付けます。

ルブの用意がある場合は、スタビライザーへのルブの塗布を実施してから取り付けます。

ルブの塗布の方法に関しては、こちらのサリチル酸様のWebページが非常に参考になるかと思います。(この場を借りて重ねて感謝申し上げます。)
[スタビライザーのルブの話](https://salicylic-acid3.hatenablog.com/entry/stabilizer-lubrication）

(スタビライザー取り付け後の画像)

# トッププレートへのキースイッチ(四隅）の取り付け、はんだ付け
キースイッチ基板の時と同様、トッププレートの四隅へキースイッチを取り付け、はんだ付けします。

# 残りのキースイッチの取り付け、はんだ付け
キースイッチ基板の時と同様、残りのキースイッチを取り付け、はんだ付けします。

一部のキースイッチが基板から浮きやすい点も同様ですので注意してください。

(浮きやすいキースイッチを示す画像)

# 拡張基板へのM2x7mm スペーサー4つの取り付け
左右の拡張基板へM2x7mmスペーサー4つ(合計8個)を取り付けます。

この時点ではスペーサーは固定されないので、なくさないよう注意してください。

# スペーサーのトッププレートへのねじ止め
スペーサーをトッププレートへM2x4mmねじでねじ止めします。

以上で左右の拡張基板の組み立ては完了です。

(組み立て後の画像)

最後に、各基板を連結し、ボトムプレートを取り付けます。

# 各基板の接続、ボトムプレート、ProMicroカバーの取り付け
各基板を接続し、ボトムプレートを取り付けます。(つまりry

おおまかな流れは以下の通りです。
* ボトムプレートへのProMicro基板の仮止め
* ProMicro基板とキースイッチ基板の接続
* ボトムプレートへのキースイッチ基板の仮止め
* ボトムプレートへの拡張基板の仮止め
* キースイッチ基板と拡張基板のピンヘッダへのジャンパピンの取り付け
* ボトムプレートと各基板のねじ止め
* キースイッチ基板のトッププレートへのProMicroカバーのねじ止め


# ボトムプレートへのProMicro基板の仮止め
ボトムプレートの保護シートをはがします。

その後、ボトムプレートへProMicro基板をM2x8mmねじ2本で軽くねじ止め(仮止め)します。

軽くねじ止めするのは、後の手順で基板の位置を微調整する可能性があるためです。

部品の順番は、下から上に、M2x8mmねじの頭、ボトムプレート、M2x2㎜中空スペーサー、ProMicro基板、M2ナットの順になります。

文章だとわかりにくいので、画像も参考にしてください。

(部品の順番と、ねじ止め位置がわかる画像)

# ProMicro基板とキースイッチ基板の接続
動作テストの時と同様、ProMicro基板とキースイッチ基板を接続します。

ProMicro基板にはボトムプレートが仮止めしてあるので、キースイッチ基板はボトムプレートに乗った状態になります。

# ボトムプレートへのキースイッチ基板の仮止め
ボトムプレートへキースイッチ基板をM2x4mmねじ4本で仮止め(ガタがある程度にねじ止め)します。

# ボトムプレートへの拡張基板の仮止め
ボトムプレートへ拡張基板をM2x4mmねじ4本で仮止めします。

# キースイッチ基板と拡張基板のピンヘッダへのジャンパピンの取り付け
キースイッチ基板と拡張基板のピンヘッダが隣り合うようにそれぞれの基板の位置を微調整し、
ピンヘッダの各ピンを橋渡しするように、ジャンパピンを取り付けます。
一番下のピンから上に、一つずつ取り付けていくとよいです。

(ジャンパピン取り付け後の画像)

# ボトムプレートと各基板のねじ止め
ボトムプレートへ仮止めした各ねじを本締めします。

ProMicro基板を固定するねじについては、M2のナットが空転しないように押さえながら本締めしてください。

# キースイッチ基板のトッププレートへのProMicroカバーのねじ止め
キースイッチ基板へ取り付けてあるM2x7mmスペーサーに、ProMicroカバーをM2x3mmスリムヘッド小ねじ2本でねじ止めします。

…もしM2x7mmスペーサーの取り付けを忘れてしまった場合は、M2x3㎜スリムヘッド小ねじでM2x7mmスペーサー2つをねじ止めした後に、

M2x6㎜スペーサーでProMicroカバーをねじ止めします。

# ボトムプレートへのゴム足4つの取り付け
ボトムプレートの四隅へゴム足を取り付けます。

# キーキャップの取り付け
各キースイッチへお好みのキーキャップ(JIS配列のもの)を取り付けます。

キーキャップの取り付けが完了したら、組み立ては完了です。お疲れさまでした。

(組立完了後の画像)

# 組み立て後の動作確認
組み立て完了後、キースイッチ基板のみで行った時と同様の手順で動作確認を行います。
